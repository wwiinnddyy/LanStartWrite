<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' data:;" />
    <title>Electron Starter</title>
  </head>
  <body>
    <div class="canvas-wrap">
      <canvas id="board"></canvas>
    </div>

    <div class="floating-panel" role="toolbar" aria-label="ç»˜å›¾æ§åˆ¶">
      <div id="dragHandle" class="drag-handle" title="æ‹–åŠ¨å·¥å…·æ ">â‰¡</div>
      <div class="panel-section tools">
        <div style="display:flex;gap:8px;align-items:center">
          <button id="undoBtn" class="tool-btn" title="æ’¤é”€">â¤º</button>
          <button id="redoBtn" class="tool-btn" title="é‡åš">â¤»</button>
        </div>

        <div class="tool">
          <button id="colorTool" class="tool-btn" title="ç”»ç¬”">
            <!-- ç®€å•ç¬”å½¢ SVG å›¾æ ‡ -->
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 21l3-1 11-11-2-2L5 18 4 21z" fill="#333"/><path d="M20.7 7.3c.4-.4.4-1 0-1.4l-2.6-2.6c-.4-.4-1-.4-1.4 0l-1.8 1.8 4 4 1.8-1.8z" fill="#333"/></svg>
          </button>
          <div class="submenu colors" id="colorMenu" aria-hidden="true" data-pinned="false">
            <div class="submenu-body">
              <div class="colorRow">
              <button class="color" data-color="#000000" style="background:#000" title="é»‘"></button>
              <button class="color" data-color="#ff3b30" style="background:#ff3b30" title="çº¢"></button>
              <button class="color" data-color="#ff9500" style="background:#ff9500" title="æ©™"></button>
              <button class="color" data-color="#ffcc00" style="background:#ffcc00" title="é»„"></button>
              <button class="color" data-color="#34c759" style="background:#34c759" title="ç»¿"></button>
              <button class="color" data-color="#007aff" style="background:#007aff" title="è“"></button>
              <button class="color" data-color="#5856d6" style="background:#5856d6" title="ç´«"></button>
              </div>
              <div class="sizeControl">
                <label>å¤§å° <input id="size" type="range" min="1" max="50" value="4"></label>
              </div>
              <div class="modeLabel" id="penModeLabel">ç¬”: é»‘ / 4</div>
            </div>
            <div class="submenu-footer">
              <button class="submenu-drag-handle" title="æ‹–åŠ¨å­èœå•">â‹®</button>
              <button class="submenu-pin" title="å›ºå®š/å–æ¶ˆå›ºå®š">ğŸ“Œ</button>
            </div>
          </div>
        </div>

        <div class="tool">
          <button id="eraserTool" class="tool-btn" title="æ©¡çš®/æ›´å¤š">
            <!-- ç®€å•æ©¡çš®å›¾æ ‡ -->
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 17.25L11.03 9.22 14.78 13l-8.03 8.03H3v-3.78z" fill="#333"/><path d="M20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 4 4 1.58-1.08z" fill="#333"/></svg>
          </button>
          <div class="submenu actions" id="eraserMenu" aria-hidden="true" data-pinned="false">
            <div class="submenu-body">
              <div class="sizeControl">
                <label>æ©¡çš®å¤§å° <input id="eraserSize" type="range" min="1" max="100" value="20"></label>
              </div>
              <div class="eraseModes" style="padding-top:6px;display:flex;gap:6px;justify-content:center">
                <button id="erasePixel" class="mode-btn" data-mode="pixel">åƒç´ æ“¦é™¤</button>
                <button id="eraseRect" class="mode-btn" data-mode="rect">çŸ©å½¢æ“¦é™¤</button>
                <button id="eraseStroke" class="mode-btn" data-mode="stroke">æ•´ç¬”åˆ é™¤</button>
              </div>
              <div class="modeLabel" id="eraserModeLabel">æ©¡çš®æ¨¡å¼: åƒç´ æ“¦é™¤</div>
              <div style="padding-top:6px">
                <button id="clear" title="æ¸…ç©ºç”»å¸ƒ">æ¸…é™¤é¡µé¢</button>
              </div>
            </div>
            <div class="submenu-footer">
              <button class="submenu-drag-handle" title="æ‹–åŠ¨å­èœå•">â‹®</button>
              <button class="submenu-pin" title="å›ºå®š/å–æ¶ˆå›ºå®š">ğŸ“Œ</button>
            </div>
          </div>
        </div>
      </div>

      <!-- size moved into color submenu -->
    </div>

    <script type="module" src="renderer.js"></script>
    <script type="module" src="ui-tools.js"></script>
    <script type="module" src="page.js"></script>
    <style>
      html,body{height:100%;margin:0;font-family:Arial,Helvetica,sans-serif}
      .canvas-wrap{height:100%;background:white;display:flex}
      #board{flex:1;display:block;width:100%;height:100%;touch-action:none}
      .floating-panel{position:fixed;right:20px;top:80px;width:220px;border-radius:18px;padding:12px;background:rgba(255,255,255,0.96);box-shadow:0 8px 24px rgba(0,0,0,0.15);z-index:3000;display:flex;flex-direction:column;gap:10px;align-items:center}
      .floating-panel .panel-section{width:100%;display:flex;gap:8px;align-items:center;justify-content:center}
      .floating-panel .tools{justify-content:space-around}
      .tool{position:relative}
      .tool-btn{width:44px;height:44px;border-radius:10px;border:1px solid #ccc;background:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer}
      .tool-btn.active{box-shadow:inset 0 -2px 0 rgba(0,0,0,0.06);background:#f6f6f6}
      /* å­èœå•ä¸ºå›ºå®šæ’ç‰ˆï¼šå›ºå®šå®½åº¦ï¼Œè‡ªé€‚åº”é«˜åº¦åŒ…å«æ‰€æœ‰æ§ä»¶ */
      .submenu{position:absolute;right:0;top:48px;background:rgba(255,255,255,0.97);padding:0;border-radius:14px;box-shadow:0 8px 22px rgba(0,0,0,0.12);display:none;z-index:2500;width:240px;box-sizing:border-box;transition:top 0.3s cubic-bezier(0.25,0.46,0.45,0.94),opacity 0.3s ease;flex-direction:column;overflow:hidden}
      .submenu.open{display:flex}
      .submenu .submenu-body{padding:12px;display:flex;flex-direction:column;gap:8px}
      .submenu .submenu-pin{border:1px solid #ccc;background:#fff;padding:6px 8px;border-radius:8px;cursor:pointer}
      .submenu .submenu-footer{display:flex;justify-content:flex-end;gap:8px;padding:8px 12px;border-top:1px solid #e5e5e5;background:rgba(255,255,255,0.5)}
      .submenu .submenu-drag-handle{border:1px solid #ccc;background:#fff;padding:6px 8px;border-radius:8px;cursor:grab}
      .submenu.colors{width:240px;box-sizing:border-box}
      /* é¢œè‰²åŒºå›ºå®šç½‘æ ¼ï¼ˆä¸¤è¡Œï¼‰ */
      .colorRow{display:grid;grid-template-columns:repeat(7,28px);grid-auto-rows:28px;gap:8px;justify-content:start}
      .submenu.colors .color{width:28px;height:28px;border-radius:6px;border:1px solid #ddd;cursor:pointer}
      .submenu .sizeControl{width:100%;display:flex;align-items:center;justify-content:center;padding-top:8px}
      .submenu .sizeControl input{width:120px}
      .submenu.actions button{padding:6px 10px;border-radius:8px;border:1px solid #ccc;background:#fff;cursor:pointer}
      .mode-btn{padding:6px 8px;border-radius:6px;border:1px solid #ccc;background:#fff;cursor:pointer}
      .mode-btn.active{background:#e6f0ff;border-color:#6ca0ff}
      .modeLabel{font-size:12px;color:#444;padding-top:6px;text-align:center}
      #undoBtn,#redoBtn{width:36px;height:36px;border-radius:8px;border:1px solid #ccc;background:#fff;cursor:pointer}
      #undoBtn:hover,#redoBtn:hover{background:#f3f6ff}
      .drag-handle{position:absolute;right:-14px;top:50%;transform:translateY(-50%);width:28px;height:48px;border-radius:8px;background:linear-gradient(180deg,#f5f5f5,#eee);border:1px solid #ccc;display:flex;align-items:center;justify-content:center;cursor:grab;box-shadow:0 4px 12px rgba(0,0,0,0.08)}
      .drag-handle:active{cursor:grabbing}
      .floating-panel label{font-size:13px}
    </style>
  </body>
</html>
